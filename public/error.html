
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ErrorHandler | Error Control Software</title>
    <style>

        @import url(https://cdn.jsdelivr.net/npm/firacode@6.2.0/distr/fira_code.css);

        body {
            font-family: "Roboto", arial, sans-serif;
        }

        code {

            font-family: 'Fira Code', monospace;
        }

        #errorTable {
            margin: 40px auto 0;
            display: table;
            width: 1000px;
            min-width: 1000px;
            min-height: 600px;
            border-collapse: collapse;
        }

        td, th {
            padding: 0.4em;
            border: #ddd 1px solid;
        }

        .col1 {
            font-weight: 700;
            width: 16%;
            text-align: right;
        }

        .col2 {
            width: 84%;
            text-align: left;
        }

        .head {
            height: 40px;
            font-size: 24px;
            background-color: #d23d24;
            color: white;
        }

        .footer {
            height: 40px;
            font-size: 24px;
            background-color: #365D95;
            color: white;
            margin: unset;
        }

        .top {
            vertical-align: top;
        }

        a {
            text-decoration: none;
            color: white;
        }

        .row-1 {
            height: 30px;
            font-size: 18px;
        }

        .container-track {
            font-family: 'Fira Code', monospace;
            font-size: 12px;
            min-height: 30px;
            height: 150px;
            max-height: 150px;
            overflow-x: auto;
            overflow-y: auto;
        }

        .container-code {
            min-height: 30px;
            height: 275px;
            max-height: 275px;
        }

        code {
            display: block;
            height: 100%;
            font-size: 12px;
            overflow-x: auto;
            overflow-y: auto;
        }

    </style>
</head>

<body>
<div style="display: flex; align-items: center; height: 100%">
    <table id="errorTable">
        <tr>
            <th colspan="2" class="head">ErrorHandler</th>
        </tr>
        <tr class="row-1">
            <td class="col1">Description:</td>
            <td class="col2">file_get_contents(/var/www/html/lh-2.dock/Asset/resource/config/app.json): Failed to open stream: No such file or directory</td>
        </tr>
        <tr class="row-1">
            <td class="col1">File:</td>
            <td class="col2">/var/www/html/lh-2.dock/Asset/Helper/Installer/Installation.php</td>
        </tr>
        <tr class="row-1">
            <td></td>
            <td>
                <b>Line: </b>227                <b>Level: </b>2                <b>Time: </b>1725726294            </td>
        </tr>
        <tr class="row-3">
            <td class="col1 top">BackTrace Log:</td>
            <td class="col2">
                <div class="container-track">/var/www/html/lh-2.dock/Asset/Helper/Installer/Installation.php 227 calling Method: file_get_contents('/var/www/html/lh-2.dock/Asset/resource/config/app.json')<br>/var/www/html/lh-2.dock/Asset/Helper/Installer/Installation.php 104 calling Method: setJSON()<br>/var/www/html/lh-2.dock/Asset/Helper/Installer/Installation.php 43 calling Method: __construct()<br>/var/www/html/lh-2.dock/Asset/resource/function/init_loader.php 41 calling Method: getInstance()<br>/var/www/html/lh-2.dock/public/setup.php 27 calling Method: install()</div>
            </td>
        </tr>
        <tr class="row-3">
            <td class="col1 top">Related Code View</td>
            <td class="col2 container-code"><pre><code style="color: #000000"><span style="color: #0000BB">&lt;?php

</span><span style="color: #007700">declare(</span><span style="color: #0000BB">strict_types</span><span style="color: #007700">=</span><span style="color: #0000BB">1</span><span style="color: #007700">);

</span><span style="color: #FF8000">/**
 * Last Hammer Framework 2.0
 * PHP Version 8.3 (Required).
 *
 * @see https://github.com/arcanisgk/LH-Framework
 *
 * @author    Walter Nu√±ez (arcanisgk/original founder) &lt;icarosnet@gmail.com&gt;
 * @copyright 2017-2024
 * @license   http://www.gnu.org/copyleft/lesser.html GNU Lesser General Public License
 * @note      This program is distributed in the hope that it will be useful
 * WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 * or FITNESS FOR A PARTICULAR PURPOSE.
 */

</span><span style="color: #007700">namespace </span><span style="color: #0000BB">Asset\Helper\Installer</span><span style="color: #007700">;

use </span><span style="color: #0000BB">Asset</span><span style="color: #007700">\{</span><span style="color: #0000BB">Framework\Core\Database</span><span style="color: #007700">, </span><span style="color: #0000BB">Framework\Core\Files</span><span style="color: #007700">};
use </span><span style="color: #0000BB">PHPMailer\PHPMailer\Exception</span><span style="color: #007700">;

</span><span style="color: #FF8000">/**
 * Class Installation
 * A simple for the installation and setup of adp
 */
</span><span style="color: #007700">class </span><span style="color: #0000BB">Installation
</span><span style="color: #007700">{
    </span><span style="color: #FF8000">/**
     * @var Installation|null Singleton instance of the Installation.
     */
    </span><span style="color: #007700">private static ?</span><span style="color: #0000BB">self $instance </span><span style="color: #007700">= </span><span style="color: #0000BB">null</span><span style="color: #007700">;

    </span><span style="color: #FF8000">/**
     * Get the singleton instance of Installation.
     *
     * @return Installation The singleton instance.
     */
    </span><span style="color: #007700">public static function </span><span style="color: #0000BB">getInstance</span><span style="color: #007700">(): </span><span style="color: #0000BB">self
    </span><span style="color: #007700">{
        if (!</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">$instance </span><span style="color: #007700">instanceof </span><span style="color: #0000BB">self</span><span style="color: #007700">) {
            </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">$instance </span><span style="color: #007700">= new </span><span style="color: #0000BB">self</span><span style="color: #007700">();
        }

        return </span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">$instance</span><span style="color: #007700">;
    }


    private array </span><span style="color: #0000BB">$templateConfEmail
        </span><span style="color: #007700">= [
            </span><span style="color: #DD0000">"mail_name"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_host"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_port"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_user"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_password"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_password_re"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_default"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_test_smg"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_protocol"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_authentication"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_debug"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"mail_test"</span><span style="color: #007700">,
        ];


    private array </span><span style="color: #0000BB">$templateConfFTP
        </span><span style="color: #007700">= [
            </span><span style="color: #DD0000">"ftp_name"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_host"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_port"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_user"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_password"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_password_re"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_path"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"ftp_passive_mode"</span><span style="color: #007700">,
        ];

    private array </span><span style="color: #0000BB">$templateConfDatabase
        </span><span style="color: #007700">= [
            </span><span style="color: #DD0000">"db_name"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"db_host"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"db_port"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"db_user"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"db_password"</span><span style="color: #007700">,
            </span><span style="color: #DD0000">"db_password_re"</span><span style="color: #007700">,
        ];

    </span><span style="color: #FF8000">/**
     *
     */
    </span><span style="color: #007700">public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">()
    {
        if (isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">)) {
            if (isset(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'Data-Base-Test'</span><span style="color: #007700">])) {
                </span><span style="color: #0000BB">$dbParams </span><span style="color: #007700">= [
                    </span><span style="color: #DD0000">'host' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'i-database-host'</span><span style="color: #007700">],
                    </span><span style="color: #DD0000">'db'   </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'i-database-name'</span><span style="color: #007700">],
                    </span><span style="color: #DD0000">'user' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'i-database-user'</span><span style="color: #007700">],
                    </span><span style="color: #DD0000">'pass' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'i-database-password'</span><span style="color: #007700">],
                ];
                echo </span><span style="color: #0000BB">Database</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">testConnection</span><span style="color: #007700">(</span><span style="color: #0000BB">$dbParams</span><span style="color: #007700">) ? </span><span style="color: #DD0000">'true' </span><span style="color: #007700">: </span><span style="color: #DD0000">'false'</span><span style="color: #007700">;
            } else {
                echo </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setJSON</span><span style="color: #007700">() ? </span><span style="color: #DD0000">'true' </span><span style="color: #007700">: </span><span style="color: #DD0000">'false'</span><span style="color: #007700">;
            }
        } else {
            </span><span style="color: #0000BB">$templatePath </span><span style="color: #007700">= </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #0000BB">DS</span><span style="color: #007700">, [</span><span style="color: #DD0000">'Asset'</span><span style="color: #007700">, </span><span style="color: #DD0000">'resource'</span><span style="color: #007700">, </span><span style="color: #DD0000">'template'</span><span style="color: #007700">, </span><span style="color: #DD0000">'install.html'</span><span style="color: #007700">]);
            echo </span><span style="color: #0000BB">Files</span><span style="color: #007700">::</span><span style="color: #0000BB">getInstance</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">fileLoader</span><span style="color: #007700">(</span><span style="color: #0000BB">$templatePath</span><span style="color: #007700">);
        }
    }

    </span><span style="color: #FF8000">/**
     * @param array $configArray
     * @param array $passwordArray
     * @param array $nodes
     * @return array
     */
    </span><span style="color: #007700">function </span><span style="color: #0000BB">replacePlaceholdersWithPasswords</span><span style="color: #007700">(
        array </span><span style="color: #0000BB">$configArray</span><span style="color: #007700">,
        array </span><span style="color: #0000BB">$passwordArray</span><span style="color: #007700">,
        </span><span style="color: #0000BB">string $type</span><span style="color: #007700">,
        array </span><span style="color: #0000BB">$nodes
    </span><span style="color: #007700">): array {
        </span><span style="color: #0000BB">$result        </span><span style="color: #007700">= [];
        </span><span style="color: #0000BB">$stringArray   </span><span style="color: #007700">= [];
        </span><span style="color: #0000BB">$passwordIndex </span><span style="color: #007700">= </span><span style="color: #0000BB">0</span><span style="color: #007700">;

        foreach (</span><span style="color: #0000BB">$configArray </span><span style="color: #007700">as </span><span style="color: #0000BB">$index </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$config</span><span style="color: #007700">) {
            </span><span style="color: #0000BB">$config </span><span style="color: #007700">= </span><span style="color: #0000BB">preg_replace_callback</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\*\*\*/'</span><span style="color: #007700">, function () use (&amp;</span><span style="color: #0000BB">$passwordIndex</span><span style="color: #007700">, </span><span style="color: #0000BB">$passwordArray</span><span style="color: #007700">) {
                return </span><span style="color: #0000BB">$passwordArray</span><span style="color: #007700">[</span><span style="color: #0000BB">$passwordIndex</span><span style="color: #007700">++];
            }, </span><span style="color: #0000BB">$config</span><span style="color: #007700">, </span><span style="color: #0000BB">2</span><span style="color: #007700">); </span><span style="color: #FF8000">// Limitamos a 2 reemplazos

            </span><span style="color: #0000BB">$stringArray</span><span style="color: #007700">[</span><span style="color: #0000BB">$index</span><span style="color: #007700">] = </span><span style="color: #0000BB">$config</span><span style="color: #007700">;
        }

        foreach (</span><span style="color: #0000BB">$stringArray </span><span style="color: #007700">as </span><span style="color: #0000BB">$index </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$config</span><span style="color: #007700">) {
            </span><span style="color: #0000BB">$ArrayString </span><span style="color: #007700">= </span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">','</span><span style="color: #007700">, </span><span style="color: #0000BB">$config</span><span style="color: #007700">);
            </span><span style="color: #0000BB">$configArray </span><span style="color: #007700">= [];
            foreach (</span><span style="color: #0000BB">$nodes </span><span style="color: #007700">as </span><span style="color: #0000BB">$key </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$nodeName</span><span style="color: #007700">) {
                </span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">$ArrayString</span><span style="color: #007700">[</span><span style="color: #0000BB">$key</span><span style="color: #007700">];
                </span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">is_numeric</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">) &amp;&amp; !</span><span style="color: #0000BB">str_contains</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #DD0000">'.'</span><span style="color: #007700">)
                    ? (int)</span><span style="color: #0000BB">$value
                    </span><span style="color: #007700">: (</span><span style="color: #0000BB">$value </span><span style="color: #007700">=== </span><span style="color: #DD0000">'true' </span><span style="color: #007700">|| </span><span style="color: #0000BB">$value </span><span style="color: #007700">=== </span><span style="color: #DD0000">'false'
                        </span><span style="color: #007700">? </span><span style="color: #0000BB">filter_var</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #0000BB">FILTER_VALIDATE_BOOLEAN</span><span style="color: #007700">)
                        : </span><span style="color: #0000BB">$value</span><span style="color: #007700">);

                </span><span style="color: #0000BB">$configArray</span><span style="color: #007700">[</span><span style="color: #0000BB">$nodeName</span><span style="color: #007700">] = </span><span style="color: #0000BB">$value</span><span style="color: #007700">;
            }
            </span><span style="color: #0000BB">$result</span><span style="color: #007700">[</span><span style="color: #0000BB">$type</span><span style="color: #007700">.(</span><span style="color: #0000BB">$index </span><span style="color: #007700">+ </span><span style="color: #0000BB">1</span><span style="color: #007700">)] = </span><span style="color: #0000BB">$configArray</span><span style="color: #007700">;
        }

        return </span><span style="color: #0000BB">$result</span><span style="color: #007700">;
    }


    private function </span><span style="color: #0000BB">setJSON</span><span style="color: #007700">(): </span><span style="color: #0000BB">bool
    </span><span style="color: #007700">{


        </span><span style="color: #0000BB">$session_lifetime </span><span style="color: #007700">= (</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-lifetime-hours'</span><span style="color: #007700">] * </span><span style="color: #0000BB">3600</span><span style="color: #007700">) + (</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-lifetime-days'</span><span style="color: #007700">] * </span><span style="color: #0000BB">86400</span><span style="color: #007700">);

        </span><span style="color: #0000BB">$session_activity_expire </span><span style="color: #007700">= (</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-activity-expire-hours'</span><span style="color: #007700">] * </span><span style="color: #0000BB">3600</span><span style="color: #007700">) + (</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-activity-expire-days'</span><span style="color: #007700">] * </span><span style="color: #0000BB">86400</span><span style="color: #007700">);

        </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-mail-conf'</span><span style="color: #007700">] = </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">replacePlaceholdersWithPasswords</span><span style="color: #007700">(
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-mail-conf'</span><span style="color: #007700">],
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-mail-conf-password'</span><span style="color: #007700">],
            </span><span style="color: #DD0000">'mail'</span><span style="color: #007700">,
            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">templateConfEmail
        </span><span style="color: #007700">);


        </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-ftp-conf'</span><span style="color: #007700">] = </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">replacePlaceholdersWithPasswords</span><span style="color: #007700">(
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-ftp-conf'</span><span style="color: #007700">],
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-ftp-conf-password'</span><span style="color: #007700">],
            </span><span style="color: #DD0000">'ftp'</span><span style="color: #007700">,
            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">templateConfFTP
        </span><span style="color: #007700">);


        </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-database-conf'</span><span style="color: #007700">] = </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">replacePlaceholdersWithPasswords</span><span style="color: #007700">(
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-database-conf'</span><span style="color: #007700">],
            </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-database-conf-password'</span><span style="color: #007700">],
            </span><span style="color: #DD0000">'db'</span><span style="color: #007700">,
            </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">templateConfDatabase
        </span><span style="color: #007700">);

        try {
            </span><span style="color: #0000BB">$filePaths </span><span style="color: #007700">= [
                </span><span style="color: #DD0000">'app.json'     </span><span style="color: #007700">=&gt; [
                    </span><span style="color: #DD0000">'company' </span><span style="color: #007700">=&gt; [
                        </span><span style="color: #DD0000">'company_name'  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-company-name'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'company_owner' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-company-owner'</span><span style="color: #007700">],
                    ],
                    </span><span style="color: #DD0000">'project' </span><span style="color: #007700">=&gt; [
                        </span><span style="color: #DD0000">'project_name'   </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-project-name'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'project_config' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">true</span><span style="color: #007700">,
                    ],
                    </span><span style="color: #DD0000">'host'    </span><span style="color: #007700">=&gt; [
                        </span><span style="color: #DD0000">'domain'   </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-domain'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'lang'     </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-lang'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'m-lang'   </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-m-lang'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'protocol' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-protocol'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'entry'    </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-entry'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'license'  </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-license'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'free'     </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-chk-license'</span><span style="color: #007700">],
                    ],
                ],
                </span><span style="color: #DD0000">'session.json' </span><span style="color: #007700">=&gt; [
                    </span><span style="color: #DD0000">'session' </span><span style="color: #007700">=&gt; [
                        </span><span style="color: #DD0000">'session_name'            </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-name'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'session_inactivity'      </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-inactivity'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'session_lifetime'        </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$session_lifetime</span><span style="color: #007700">,
                        </span><span style="color: #DD0000">'session_activity_expire' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$session_activity_expire</span><span style="color: #007700">,
                        </span><span style="color: #DD0000">'session_secure'          </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-secure'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'session_httponly'        </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-http-only'</span><span style="color: #007700">],
                        </span><span style="color: #DD0000">'session_same_site'       </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-session-same-site'</span><span style="color: #007700">] ? </span><span style="color: #DD0000">'Strict' </span><span style="color: #007700">: </span><span style="color: #DD0000">'Lax'</span><span style="color: #007700">,
                    ],
                ],
                </span><span style="color: #DD0000">'mail.json'    </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-mail-conf'</span><span style="color: #007700">],
                </span><span style="color: #DD0000">'ftp.json'     </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-ftp-conf'</span><span style="color: #007700">],
                </span><span style="color: #DD0000">'json.json'    </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'json-database-conf'</span><span style="color: #007700">],
            ];
            
            foreach (</span><span style="color: #0000BB">$filePaths </span><span style="color: #007700">as </span><span style="color: #0000BB">$fileName </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$postData</span><span style="color: #007700">) {

                </span><span style="color: #0000BB">$filePath </span><span style="color: #007700">= </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #0000BB">DS</span><span style="color: #007700">, [</span><span style="color: #0000BB">PD</span><span style="color: #007700">, </span><span style="color: #DD0000">'Asset'</span><span style="color: #007700">, </span><span style="color: #DD0000">'resource'</span><span style="color: #007700">, </span><span style="color: #DD0000">'config'</span><span style="color: #007700">, </span><span style="color: #0000BB">$fileName</span><span style="color: #007700">]);
                </span><span style="color: #0000BB">$config   </span><span style="color: #007700">= </span><span style="color: #0000BB">json_decode</span><span style="color: #007700">(</span><span style="color: #0000BB">file_get_contents</span><span style="color: #007700">(</span><span style="color: #0000BB">$filePath</span><span style="color: #007700">), </span><span style="color: #0000BB">true</span><span style="color: #007700">);    </span><span style="color: #FF8000">// error detected in this line!!!
                </span><span style="color: #0000BB">$config   </span><span style="color: #007700">= </span><span style="color: #0000BB">array_replace_recursive</span><span style="color: #007700">(</span><span style="color: #0000BB">$config</span><span style="color: #007700">, </span><span style="color: #0000BB">$postData</span><span style="color: #007700">);

                </span><span style="color: #0000BB">array_walk_recursive</span><span style="color: #007700">(</span><span style="color: #0000BB">$config</span><span style="color: #007700">, function (&amp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">) {
                    if (!</span><span style="color: #0000BB">is_bool</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">) &amp;&amp; !</span><span style="color: #0000BB">is_int</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">)) {
                        </span><span style="color: #0000BB">$value </span><span style="color: #007700">= </span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">, </span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">, </span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$value</span><span style="color: #007700">));
                    }
                });

                </span><span style="color: #0000BB">file_put_contents</span><span style="color: #007700">(
                    </span><span style="color: #0000BB">$filePath</span><span style="color: #007700">,
                    </span><span style="color: #0000BB">json_encode</span><span style="color: #007700">(
                        </span><span style="color: #0000BB">$config</span><span style="color: #007700">,
                        </span><span style="color: #0000BB">JSON_HEX_TAG </span><span style="color: #007700">| </span><span style="color: #0000BB">JSON_HEX_APOS </span><span style="color: #007700">| </span><span style="color: #0000BB">JSON_HEX_QUOT </span><span style="color: #007700">| </span><span style="color: #0000BB">JSON_HEX_AMP </span><span style="color: #007700">| </span><span style="color: #0000BB">JSON_UNESCAPED_UNICODE </span><span style="color: #007700">| </span><span style="color: #0000BB">JSON_PRETTY_PRINT
                    </span><span style="color: #007700">)
                );

            }

            </span><span style="color: #0000BB">$sourceFile      </span><span style="color: #007700">= </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #0000BB">DS</span><span style="color: #007700">, [</span><span style="color: #0000BB">PD</span><span style="color: #007700">, </span><span style="color: #DD0000">'public'</span><span style="color: #007700">, </span><span style="color: #DD0000">'setup.php'</span><span style="color: #007700">]);
            </span><span style="color: #0000BB">$destinationFile </span><span style="color: #007700">= </span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #0000BB">DS</span><span style="color: #007700">, [</span><span style="color: #0000BB">PD</span><span style="color: #007700">, </span><span style="color: #DD0000">'Asset'</span><span style="color: #007700">, </span><span style="color: #DD0000">'resource'</span><span style="color: #007700">, </span><span style="color: #DD0000">'recicle_bin'</span><span style="color: #007700">, </span><span style="color: #DD0000">'setup.php'</span><span style="color: #007700">]);

            if (!</span><span style="color: #0000BB">copy</span><span style="color: #007700">(</span><span style="color: #0000BB">$sourceFile</span><span style="color: #007700">, </span><span style="color: #0000BB">$destinationFile</span><span style="color: #007700">)) {
                throw new </span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">'Failed to copy setup.php'</span><span style="color: #007700">);
            }

            if (!</span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #0000BB">$sourceFile</span><span style="color: #007700">)) {
                throw new </span><span style="color: #0000BB">Exception</span><span style="color: #007700">(</span><span style="color: #DD0000">'Failed to delete setup.php'</span><span style="color: #007700">);
            }

            return </span><span style="color: #0000BB">true</span><span style="color: #007700">;
        } catch (</span><span style="color: #0000BB">Exception $e</span><span style="color: #007700">) {
            return </span><span style="color: #0000BB">false</span><span style="color: #007700">;
        }
    }
}</span></code></pre></td>
        </tr>
        <tr>
            <th colspan="2" class="footer">Please try to <a href="#" id="return">Go Back</a></th>
        </tr>
    </table>
</div>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        function refresh() {
            document.location.href = "/";
        }

        document.getElementById("return").addEventListener("click", function () {
            refresh();
        });
    });
</script>
</body>

</html>